# Сервис обработки изображений

Создайте .env файл по шаблону .env_template:
```
cp .env_template .envv
```

Запуск проекта:
```
docker-compose up
```

Для хранения изображений используется s3-хранилище (необходимо зарегистрировать сервисный аккаунт и указать ключи в .env файле).


## Описание
Архитектура проекта: project_architecture.png

### 1. Веб-API - Django
/src
Можно создать суперпользователя кастомной командой (используются username и password из .env файла):
```
python manage.py create_superuser
```

*Функции*:
- Загрузка нового изображения.
- Получение списка всех загруженных изображений.
- Получение информации о конкретном изображении по id.
- Обновление информации об изображении (имени и/или описания).
- Удаление изображения.

При загрузке нового изображения создается запись в БД, далее id и изображение в байтовом представлении направляется в брокер сообщений, который направляет данные в сервис по обработке изображений.


### 2. Обработка изображений
/image_processing_service
Сервис запускается и ожидает сообщения от брокера. При получении сообщения (id и изображение в байтовом формате) обрабатывает данное изображение, сохраняет в s3-хранилище исходное изображение (в директорию /src) и обработанное (в директорию /dst) - после этого в БД Postgres по id сохраняет данные (url исходного и обработанного изображения в s3, новое разрешение и размер). Логирует данное действие.

### 3. Аутентификация - JWT
В каждом запросе необходимо отправлять Bearer Token.

### 4. База данных - PostgreSQL

### 5. Брокер сообщений - RabbitMQ

### 6. Docker
docker-compose.yml для оркестрации сервисов:
- База данных
- Веб-приложение
- Брокер сообщений
- Сервис обработки изображений

### 7. Тестирование - pytest
Роуты веб-приложения

### 8. Документация - Swagger
/api/schema/swagger/
